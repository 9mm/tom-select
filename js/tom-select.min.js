/*! tom-select.js - v1.0.0-rc.1 | https://github.com/orchidjs/tom-select | Apache License (v2) */

!function(e,t){"function"==typeof define&&define.amd?define(["sifter","microplugin"],t):"object"==typeof exports?module.exports=t(require("sifter"),require("microplugin")):e.TomSelect=t(e.Sifter,e.MicroPlugin)}(this,function(a,e){"use strict";function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(i);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==l(e)&&"function"!=typeof e?c(t):e}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function r(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function d(){}d.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var i=arguments.length;return 0===i?delete this._events:1===i?delete this._events[e]:(this._events=this._events||{},void(e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)))},trigger:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}};function h(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function g(t,i,e){var n,o=t.trigger,s={};for(n in t.trigger=function(){var e=arguments[0];if(-1===i.indexOf(e))return o.apply(t,arguments);s[e]=arguments},e.apply(t,[]),t.trigger=o,s)s.hasOwnProperty(n)&&o.apply(t,s[n])}function f(e,t){var i=document.createEvent("HTMLEvents");i.initEvent(t,!0,!1),e.dispatchEvent(i)}function v(t,i){Object.keys(i).forEach(function(e){t.style[e]=i[e]})}function C(e){var t=O.apply(null,arguments);e=w(e);for(var i,n=0;n<e.length;n++)(i=e[n].classList).add.apply(i,r(t))}function I(e){var t=O.apply(null,arguments);e=w(e);for(var i,n=0;n<e.length;n++)(i=e[n].classList).remove.apply(i,r(t))}function m(e,t){if(!e)return-1;t=t||e.nodeName;for(var i=0;e=e.previousElementSibling;)e.matches(t)&&i++;return i}var y=function(l,e){var t,u=Object.assign({},S.defaults,e),c=u.dataAttr,p=u.labelField,d=u.valueField,h=u.disabledField,g=u.optgroupField,f=u.optgroupLabelField,v=u.optgroupValueField,i=l.tagName.toLowerCase(),n=l.getAttribute("placeholder")||l.getAttribute("data-placeholder");n||u.allowEmptyOption||(t=l.querySelector('option[value=""]'))&&(n=t.textContent);var m={placeholder:n,options:[],optgroups:[],items:[]};return("select"===i?function(){function r(e){var t=Object.assign({},e.dataset);return"string"==typeof(e=c&&t[c])&&e.length&&(t=Object.assign(t,JSON.parse(e))),t}function a(e,t){var i,n=A(e.value);(n||u.allowEmptyOption)&&(s.hasOwnProperty(n)?t&&((i=s[n][g])?Array.isArray(i)?i.push(t):s[n][g]=[i,t]:s[n][g]=t):((i=r(e))[p]=i[p]||e.textContent,i[d]=i[d]||n,i[h]=i[h]||e.disabled,i[g]=i[g]||t,s[n]=i,o.push(i),e.selected&&m.items.push(n)))}var e,t,i,n,o=m.options,s={};for(m.maxItems=l.hasAttribute("multiple")?null:1,e=0,t=(n=l.children).length;e<t;e++)"optgroup"===(i=n[e].tagName.toLowerCase())?function(e){var t,i=e.getAttribute("label");i&&((t=r(e))[f]=i,t[v]=i,t[h]=e.disabled,m.optgroups.push(t));for(var n,o=0,s=(n=e.children).length;o<s;o++)a(n[o],i)}(n[e]):"option"===i&&a(n[e])}:function(){var e,t,i,n,o=l.getAttribute(c);if(o)for(m.options=JSON.parse(o),e=0,t=m.options.length;e<t;e++)m.items.push(m.options[e][d]);else{o=l.value.trim()||"";if(u.allowEmptyOption||o.length){for(e=0,t=(i=o.split(u.delimiter)).length;e<t;e++)(n={})[p]=i[e],n[d]=i[e],m.options.push(n);m.items=i}}})(),Object.assign({},S.defaults,m,e)},A=function(e){return null==e?null:"boolean"==typeof e?e?"1":"0":e+""},b=function(e){if(e.jquery)return e[0];if(e instanceof HTMLElement)return e;if(-1<e.indexOf("<")){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}return document.querySelector(e)},O=function(){for(var e=[],t=1;t<arguments.length;t++){var i=arguments[t];"string"==typeof i&&(i=i.trim().split(/[\11\12\14\15\40]/)),Array.isArray(i)&&(e=e.concat(i))}return e.filter(Boolean)},w=function(e){return Array.isArray(e)||(e=[e]),e},k=function(e,t,i){if(!i||i.contains(e))for(;e&&e.matches;){if(e.matches(t))return e;e=e.parentNode}},_=function(e,t){return 0<t?e[e.length-1]:e[0]},S=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,d);var e,t,i,s=u(r);function r(e,t){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=c(i=s.call(this));if((e=b(e)).tomselect)throw new Error("Tom Select already initialized on this element");e.tomselect=n,t=y(e,t);var o=(window.getComputedStyle&&window.getComputedStyle(e,null)).getPropertyValue("direction");return Object.assign(n,{order:0,settings:t,input:e,tabIndex:e.getAttribute("tabindex")||"",is_select_tag:"select"===e.tagName.toLowerCase(),rtl:/rtl/i.test(o),highlightedValue:null,isBlurring:!1,isOpen:!1,isDisabled:!1,isRequired:e.required,isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},activeOption:null,activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{item:{},option:{}}}),n.settings.load&&n.settings.loadThrottle&&(n.settings.load=n.loadDebounce(n.settings.load,n.settings.loadThrottle)),n.sifter=new a(i.options,{diacritics:t.diacritics}),n.setupOptions(n.settings.options,n.settings.optgroups),delete n.settings.optgroups,delete n.settings.options,n.settings.mode=n.settings.mode||(1===n.settings.maxItems?"single":"multi"),"boolean"!=typeof n.settings.hideSelected&&(n.settings.hideSelected="multi"===n.settings.mode),"string"==typeof n.settings.createFilter&&(n.settings.createFilter=new RegExp(n.settings.createFilter)),n.initializePlugins(n.settings.plugins),n.setupCallbacks(),n.setupTemplates(),n.setup(),i}return e=r,(t=[{key:"setup",value:function(){var i,e,t,n,o,s,r=this,a=r.settings,l=r.input,u=r.settings.mode,c=l.getAttribute("class")||"",p=b("<div>");if(C(p,a.wrapperClass,c,u),i=b('<div class="items">'),C(i,a.inputClass),p.append(i),t=r.render("dropdown"),C(t,a.dropdownClass,u),n=b('<div style="scroll-behavior: smooth;">'),C(n,a.dropdownContentClass),t.append(n),b(a.dropdownParent||p).appendChild(t),a.controlInput)e=b(a.controlInput);else{e=b('<input type="text" autocomplete="off" />');for(var d=["autocorrect","autocapitalize","autocomplete"],h=0;h<d.length;h++){var g=d[h];l.getAttribute(g)&&e.setAttribute(g,l.getAttribute(g))}}a.controlInput||(e.setAttribute("tabindex",l.disabled?"-1":r.tabIndex),i.appendChild(e)),(o=l.getAttribute("id"))&&(e.setAttribute("id",o+"-tomselected"),(u=document.querySelector("label[for='"+o+"']"))&&u.setAttribute("for",o+"-tomselected")),r.settings.copyClassesToDropdown&&C(t,c),p.style.width=l.style.width,r.plugins.names.length&&(s="plugin-"+r.plugins.names.join(" plugin-"),C([p,t],s)),(null===a.maxItems||1<a.maxItems)&&r.is_select_tag&&l.setAttribute("multiple","multiple"),r.settings.placeholder&&e.setAttribute("placeholder",a.placeholder),!r.settings.splitOn&&r.settings.delimiter&&(s=r.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),r.settings.splitOn=new RegExp("\\s*"+s+"+\\s*")),e.type=l.type,r.control=i,r.control_input=e,r.wrapper=p,r.dropdown=t,r.dropdown_content=n,function(i,e,n,o){for(var t=e.split(/\s/),s=function(e){var t=k(e.target,n,i);t&&(e.delegateTarget=t,o.call(t,e))},r=0;r<t.length;r++)i.addEventListener(t[r],s,!0)}(t,"mouseenter","[data-selectable]",function(){return r.onOptionHover.apply(r,arguments)}),i.addEventListener("mousedown",function(e){var t=k(e.target,"."+r.settings.itemClass,i);return t?(e.delegateTarget=t,r.onItemSelect.call(r,e)):r.onMouseDown.call(r,e)}),i.addEventListener("click",function(){return r.onClick.apply(r,arguments)}),e.addEventListener("mousedown",function(e){e.stopPropagation()}),e.addEventListener("keydown",function(){return r.onKeyDown.apply(r,arguments)}),e.addEventListener("keyup",function(){return r.onKeyUp.apply(r,arguments)}),e.addEventListener("keypress",function(){return r.onKeyPress.apply(r,arguments)}),e.addEventListener("resize",function(){r.positionDropdown.apply(r,[])}),e.addEventListener("blur",function(){return r.onBlur.apply(r,arguments)}),e.addEventListener("focus",function(){return r.ignoreBlur=!1,r.onFocus.apply(r,arguments)}),e.addEventListener("paste",function(){return r.onPaste.apply(r,arguments)});function f(e){var t;k(e.target,"."+r.settings.wrapperClass,r.wrapper)?(e.preventDefault(),e.stopPropagation(),(t=k(e.target,"[data-selectable]",r.wrapper))&&r.onOptionSelect(t,!0)):r.isFocused&&r.blur(e.target)}function v(){r.isOpen&&r.positionDropdown.apply(r,arguments)}function m(){r.ignoreHover=!1}document.addEventListener("mousedown",f),window.addEventListener("sroll",v),window.addEventListener("resize",v),window.addEventListener("mousemove",m),r._destroy=function(){document.removeEventListener("mousedown",f),window.removeEventListener("mousemove",m),window.removeEventListener("sroll",v),window.removeEventListener("resize",v)};for(var y=[];0<l.children.length;)y.push(l.children[0]),l.children[0].remove();this.revertSettings={children:y,tabindex:l.getAttribute("tabindex")},l.setAttribute("tabindex",-1),l.setAttribute("hidden","hidden"),l.insertAdjacentElement("afterend",r.wrapper),r.setValue(a.items),delete a.items,l.addEventListener("invalid",function(e){e.preventDefault(),r.isInvalid||(r.isInvalid=!0,r.refreshState())}),r.updateOriginalInput(),r.refreshItems(),r.refreshState(),r.isSetup=!0,l.disabled&&r.disable(),r.on("change",this.onChange),C(l,"tomselected"),r.trigger("initialize"),!0===a.preload&&r.onSearchChange("")}},{key:"setupOptions",value:function(e,t){var i,n;for(t=t||[],i=0,n=(e=e||[]).length;i<n;i++)this.registerOption(e[i]);for(i=0,n=t.length;i<n;i++)this.registerOptionGroup(t[i])}},{key:"setupTemplates",value:function(){var i=this.settings.labelField,n=this.settings.optgroupLabelField,e={optgroup:function(e,t){var i=document.createElement("div");return i.className="optgroup",i.appendChild(e.options),i},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[n])+"</div>"},option:function(e,t){return"<div>"+t(e[i])+"</div>"},item:function(e,t){return"<div>"+t(e[i])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"},no_results:function(){return'<div class="no-results">No results found</div>'},loading:function(){return'<div class="spinner"></div>'},dropdown:function(){return'<div style="display:none"></div>'}};this.settings.render=Object.assign({},e,this.settings.render)}},{key:"setupCallbacks",value:function(){var e,t,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i)(t=this.settings[i[e]])&&this.on(e,t)}},{key:"onClick",value:function(e){this.isFocused&&this.isOpen||(this.focus(),e.preventDefault())}},{key:"onMouseDown",value:function(e){var t=this;if(t.isFocused){if(e.target!==t.control_input)return"single"===t.settings.mode?t.isOpen?t.close():t.open():t.setActiveItem(null),!1}else window.setTimeout(function(){t.focus()},0)}},{key:"onChange",value:function(){f(this.input,"change")}},{key:"onPaste",value:function(e){var o=this;o.isFull()||o.isInputHidden||o.isLocked?e.preventDefault():o.settings.splitOn&&setTimeout(function(){var e=o.inputValue();if(e.match(o.settings.splitOn))for(var t=e.trim().split(o.settings.splitOn),i=0,n=t.length;i<n;i++)o.createItem(t[i])},0)}},{key:"onKeyPress",value:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&t===this.settings.delimiter?(this.createItem(),e.preventDefault(),!1):void 0}},{key:"onKeyDown",value:function(e){var t,i=this;e.target,i.control_input;if(i.ignoreHover=!0,i.isLocked)9!==e.keyCode&&e.preventDefault();else{switch(e.keyCode){case 65:if(i.isKeyDown(17,e))return void i.selectAll();break;case 27:return void(i.isOpen&&(e.preventDefault(),e.stopPropagation(),i.close()));case 40:return!i.isOpen&&i.hasOptions?i.open():!i.activeOption||(t=i.getAdjacent(i.activeOption,1))&&i.setActiveOption(t,!0),void e.preventDefault();case 38:return!i.activeOption||(t=i.getAdjacent(i.activeOption,-1))&&i.setActiveOption(t,!0),void e.preventDefault();case 13:return void(i.isOpen&&i.activeOption&&(i.onOptionSelect(i.activeOption),e.preventDefault()));case 37:return void i.advanceSelection(-1,e);case 39:return void i.advanceSelection(1,e);case 9:return i.settings.selectOnTab&&i.isOpen&&i.activeOption&&(i.onOptionSelect(i.activeOption),e.preventDefault()),void(i.settings.create&&i.createItem()&&e.preventDefault());case 8:case 46:return void i.deleteSelection(e)}i.isInputHidden&&!i.isKeyDown(17,e)&&e.preventDefault()}}},{key:"onKeyUp",value:function(e){var t=this;if(t.isLocked)return e&&e.preventDefault();e=t.inputValue();t.lastValue!==e&&(t.lastValue=e,t.onSearchChange(e),t.refreshOptions(),t.trigger("type",e))}},{key:"onSearchChange",value:function(t){var i=this,n=i.settings.load;n&&(i.loadedSearches.hasOwnProperty(t)||(i.loadedSearches[t]=!0,i.load(function(e){n.apply(i,[t,e])})))}},{key:"onFocus",value:function(e){var t=this,i=t.isFocused;if(t.isDisabled)return t.blur(),e&&e.preventDefault(),!1;t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.onSearchChange(""),i||t.trigger("focus"),t.activeItems.length||(t.showInput(),t.setActiveItem(null),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())}},{key:"onBlur",value:function(e,t){var i=this;if(i.isFocused){if(i.isFocused=!1,i.ignoreFocus=!1,!i.ignoreBlur&&document.activeElement===i.dropdown_content)return i.ignoreBlur=!0,void i.onFocus(e);e=function(){i.close(),i.setActiveItem(null),i.setActiveOption(null),i.setCaret(i.items.length),i.refreshState(),t&&t.focus&&t.focus(),i.isBlurring=!1,i.trigger("blur")};i.isBlurring=!0,i.settings.create&&i.settings.createOnBlur?i.createItem(null,!1,e):e()}}},{key:"onOptionHover",value:function(e){this.ignoreHover||this.setActiveOption(e.delegateTarget,!1)}},{key:"onOptionSelect",value:function(e,t){var i=this;e&&(e.parentNode&&e.parentNode.matches("[data-disabled]")||(e.classList.contains("create")?i.createItem(null,function(){i.settings.closeAfterSelect&&i.close()}):void 0!==(e=e.dataset.value)&&(i.lastQuery=null,i.addItem(e),i.settings.closeAfterSelect?i.close():!i.settings.hideSelected&&t&&i.setActiveOption(i.getOption(e)))))}},{key:"onItemSelect",value:function(e){this.isLocked||"multi"===this.settings.mode&&(e.preventDefault(),this.setActiveItem(e.delegateTarget,e))}},{key:"load",value:function(e){var i=this;C(i.wrapper,i.settings.loadingClass),i.loading++,e.call(i,function(e,t){i.loading=Math.max(i.loading-1,0),i.lastQuery=null,i.setupOptions(e,t),i.refreshOptions(i.isFocused&&!i.isInputHidden),i.loading||I(i.wrapper,i.settings.loadingClass),i.trigger("load",e)})}},{key:"loadDebounce",value:function(i,n){var o;return function(){var e=this,t=arguments;o&&(e.loading=Math.max(e.loading-1,0)),window.clearTimeout(o),o=window.setTimeout(function(){o=null,i.apply(e,t)},n)}}},{key:"setTextboxValue",value:function(e){var t=this.control_input;t.value!==e&&(t.value=e,f(t,"update"),this.lastValue=e)}},{key:"getValue",value:function(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)}},{key:"setValue",value:function(e,t){g(this,t?[]:["change"],function(){this.clear(t),this.addItems(e,t)})}},{key:"setActiveItem",value:function(e,t){var i,n,o,s,r;if("single"!==this.settings.mode){if(!e)return I(this.activeItems,"active"),this.activeItems=[],void(this.isFocused&&this.showInput());if("mousedown"===(i=t&&t.type.toLowerCase())&&this.isKeyDown(16,t)&&this.activeItems.length){for(r=this.getLastActive(),o=Array.prototype.indexOf.call(this.control.children,r),(s=Array.prototype.indexOf.call(this.control.children,e))<o&&(r=o,o=s,s=r),n=o;n<=s;n++)e=this.control.children[n],-1===this.activeItems.indexOf(e)&&this.setActiveItemClass(e);t.preventDefault()}else"mousedown"===i&&this.isKeyDown(17,t)||"keydown"===i&&this.isKeyDown(16,t)?e.classList.contains("active")?this.removeActiveItem(e):this.setActiveItemClass(e):(I(this.activeItems,"active"),this.activeItems=[],this.setActiveItemClass(e));this.hideInput(),this.isFocused||this.focus()}}},{key:"setActiveItemClass",value:function(e){var t=this.control.querySelector(".last-active");t&&I(t,"last-active"),C(e,"active last-active"),-1==this.activeItems.indexOf(e)&&this.activeItems.push(e)}},{key:"removeActiveItem",value:function(e){var t=this.activeItems.indexOf(e);this.activeItems.splice(t,1),I(e,"active")}},{key:"setActiveOption",value:function(e,t){var i,n;e!==this.activeOption&&(this.activeOption&&I(this.activeOption,"active"),this.activeOption=null,e&&(this.activeOption=e,C(e,"active"),!t&&void 0!==t||(i=this.dropdown_content.clientHeight,t=this.dropdown_content.scrollTop||0,n=this.activeOption.offsetHeight,i+t<(e=this.activeOption.getBoundingClientRect().top-this.dropdown_content.getBoundingClientRect().top+t)+n?this.dropdown_content.scrollTop=e-i+n:e<t&&(this.dropdown_content.scrollTop=e))))}},{key:"selectAll",value:function(){"single"!==this.settings.mode&&(this.activeItems=this.controlChildren(),this.activeItems.length&&(C(this.activeItems,"active"),this.hideInput(),this.close()),this.focus())}},{key:"hideInput",value:function(){this.settings.controlInput||(this.setTextboxValue(""),v(this.control_input,{opacity:0,position:"absolute",left:(this.rtl?1e4:-1e4)+"px"}),this.isInputHidden=!0)}},{key:"showInput",value:function(){this.settings.controlInput||(v(this.control_input,{opacity:1,position:"relative",left:0}),this.isInputHidden=!1)}},{key:"inputValue",value:function(){return this.control_input.value.trim()}},{key:"focus",value:function(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.control_input.focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0))}},{key:"blur",value:function(e){this.control_input.blur(),this.onBlur(null,e)}},{key:"getScoreFunction",value:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())}},{key:"getSearchOptions",value:function(){var e=this.settings,t=e.sortField;return"string"==typeof t&&(t=[{field:t}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}}},{key:"search",value:function(e){var t,i,n,o=this,s=o.settings,r=this.getSearchOptions();if(s.score&&"function"!=typeof(n=o.settings.score.call(this,e)))throw new Error('Tom Select "score" setting must be a function that returns a function');if(e!==o.lastQuery?(o.lastQuery=e,i=o.sifter.search(e,Object.assign(r,{score:n})),o.currentResults=i):i=Object.assign({},o.currentResults),s.hideSelected)for(t=i.items.length-1;0<=t;t--)-1!==o.items.indexOf(A(i.items[t].id))&&i.items.splice(t,1);return i}},{key:"refreshOptions",value:function(e){var t,i,n,o;void 0===e&&(e=!0);var s,r,a=this,l=a.inputValue(),u=a.search(l),c=a.activeOption&&A(a.activeOption.dataset.value),p=!1,d=u.items.length;for("number"==typeof a.settings.maxOptions&&(d=Math.min(d,a.settings.maxOptions)),0<d&&(p=!0),i={},n=[],t=0;t<d;t++)for(var h,g=a.options[u.items[t].id],f=A(g[a.settings.valueField]),v=(v=a.getOption(f))||a.render("option",g),m=g[a.settings.optgroupField]||"",y=0,b=(h=Array.isArray(m)?m:[m])&&h.length;y<b;y++)m=h[y],a.optgroups.hasOwnProperty(m)||(m=""),i.hasOwnProperty(m)||(i[m]=document.createDocumentFragment(),n.push(m)),0<y&&(v=v.cloneNode(!0),I(v,"active")),i[m].appendChild(v);for(this.settings.lockOptgroupOrder&&n.sort(function(e,t){return(a.optgroups[e].$order||0)-(a.optgroups[t].$order||0)}),o=document.createDocumentFragment(),t=0,d=n.length;t<d;t++)m=n[t],a.optgroups.hasOwnProperty(m)&&i[m].children.length?((s=document.createDocumentFragment()).appendChild(a.render("optgroup_header",a.optgroups[m])),s.appendChild(i[m]),s=a.render("optgroup",{group:a.optgroups[m],options:s}),o.appendChild(s)):o.appendChild(i[m]);if(a.dropdown_content.innerHTML="",a.dropdown_content.appendChild(o),a.settings.highlight&&(a.dropdown_content,r=document.querySelectorAll("span.highlight"),Array.prototype.forEach.call(r,function(e,t){var i=e.parentNode;i.replaceChild(e.firstChild,e),i.normalize()}),u.query.length&&u.tokens.length))for(t=0,d=u.tokens.length;t<d;t++)!function(e,t){var a,i;"string"==typeof t&&!t.length||(a="string"==typeof t?new RegExp(t,"i"):t,i=function e(t){var i=0;if(3===t.nodeType){var n,o,s=t.data.search(a);0<=s&&0<t.data.length&&(o=t.data.match(a),(n=document.createElement("span")).className="highlight",(s=t.splitText(s)).splitText(o[0].length),o=s.cloneNode(!0),n.appendChild(o),s.parentNode.replaceChild(n,s),i=1)}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName)&&("highlight"!==t.className||"SPAN"!==t.tagName))for(var r=0;r<t.childNodes.length;++r)r+=e(t.childNodes[r]);return i},i(e))}(a.dropdown_content,u.tokens[t].regex);if(!a.settings.hideSelected)for(t=0,d=a.items.length;t<d;t++){var O=a.getOption(a.items[t]);O&&C(O,"selected")}function w(e){return p=!0,e=a.render(e,{input:l}),a.dropdown_content.insertBefore(e,a.dropdown_content.firstChild),e}var k;a.loading?w("loading"):0===u.items.length&&a.settings.render.no_results&&l.length&&w("no_results"),(r=a.canCreate(l))&&(k=w("option_create")),a.hasOptions=0<u.items.length||r,p?(k=0<u.items.length?(c=c&&a.getOption(c))&&a.dropdown_content.contains(c)?c:"single"===a.settings.mode&&a.items.length?a.getOption(a.items[0]):(c=0,k&&!a.settings.addPrecedence&&(c=1),a.selectable()[c]):k,a.setActiveOption(k),e&&!a.isOpen&&a.open()):(a.setActiveOption(null),e&&a.isOpen&&a.close())}},{key:"selectable",value:function(){return this.dropdown_content.querySelectorAll("[data-selectable]")}},{key:"addOption",value:function(e){var t,i,n,o=this;if(Array.isArray(e))for(t=0,i=e.length;t<i;t++)o.addOption(e[t]);else(n=o.registerOption(e))&&(o.userOptions[n]=!0,o.lastQuery=null,o.trigger("option_add",n,e))}},{key:"registerOption",value:function(e){var t=A(e[this.settings.valueField]);return null!=t&&!this.options.hasOwnProperty(t)&&(e.$order=e.$order||++this.order,this.options[t]=e,t)}},{key:"registerOptionGroup",value:function(e){var t=A(e[this.settings.optgroupValueField]);return!!t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)}},{key:"addOptionGroup",value:function(e,t){t[this.settings.optgroupValueField]=e,(e=this.registerOptionGroup(t))&&this.trigger("optgroup_add",e,t)}},{key:"removeOptionGroup",value:function(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.clearCache(),this.trigger("optgroup_remove",e))}},{key:"clearOptionGroups",value:function(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")}},{key:"updateOption",value:function(e,t){var i,n,o,s=this;if(e=A(e),i=A(t[s.settings.valueField]),null!==e&&s.options.hasOwnProperty(e)){if("string"!=typeof i)throw new Error("Value must be set in option data");o=s.options[e].$order,i!==e&&(delete s.options[e],-1!==(n=s.items.indexOf(e))&&s.items.splice(n,1,i)),t.$order=t.$order||o,s.options[i]=t,n=s.renderCache.item,o=s.renderCache.option,n&&(delete n[e],delete n[i]),o&&(delete o[e],delete o[i]),-1!==s.items.indexOf(i)&&(e=s.getItem(e),t=s.render("item",t),e.classList.contains("active")&&C(t,"active"),e.parentNode.insertBefore(t,e),e.remove()),s.lastQuery=null,s.isOpen&&s.refreshOptions(!1)}}},{key:"removeOption",value:function(e,t){var i=this;e=A(e);var n=i.renderCache.item,o=i.renderCache.option;n&&delete n[e],o&&delete o[e],delete i.userOptions[e],delete i.options[e],i.lastQuery=null,i.trigger("option_remove",e),i.removeItem(e,t)}},{key:"clearOptions",value:function(){this.loadedSearches={},this.userOptions={},this.clearCache();var e,t={};for(e in this.options)this.options.hasOwnProperty(e)&&0<=this.items.indexOf(e)&&(t[e]=this.options[e]);this.options=this.sifter.items=t,this.lastQuery=null,this.trigger("option_clear")}},{key:"getOption",value:function(e){return this.renderCache.option.hasOwnProperty(e)?this.renderCache.option[e]:this.getElementWithValue(e,this.selectable())}},{key:"getAdjacent",value:function(e,t,i){var n=2<arguments.length&&void 0!==i?i:"option";if(e){var o=this.settings.optionClass,i=this.dropdown;"item"==n&&(i=this.control,o=this.settings.itemClass);for(var s=i.querySelectorAll("."+o),r=0;r<s.length;r++)if(s[r]==e)return 0<t?s[r+1]:s[r-1]}}},{key:"getElementWithValue",value:function(e,t){if(null!=(e=A(e)))for(var i=0,n=t.length;i<n;i++)if(t[i].getAttribute("data-value")===e)return t[i]}},{key:"getItem",value:function(e){return this.getElementWithValue(e,this.control.children)}},{key:"addItems",value:function(e,t){this.buffer=document.createDocumentFragment();for(var i=this.control.children,n=0;n<i.length;n++)this.buffer.appendChild(i[n]);for(var o=Array.isArray(e)?e:[e],n=0,s=o.length;n<s;n++)this.isPending=n<s-1,this.addItem(o[n],t);e=this.control;e.insertBefore(this.buffer,e.firstChild),this.buffer=null}},{key:"addItem",value:function(s,r){g(this,r?[]:["change"],function(){var e,t,i,n=this,o=n.settings.mode;s=A(s),(-1===n.items.indexOf(s)||("single"===o&&n.close(),"single"!==o&&n.settings.duplicates))&&n.options.hasOwnProperty(s)&&("single"===o&&n.clear(r),"multi"===o&&n.isFull()||(i=n.render("item",n.options[s]),this.control.contains(i)&&(i=i.cloneNode(!0)),t=n.isFull(),n.items.splice(n.caretPos,0,s),n.insertAtCaret(i),n.isPending&&(t||!n.isFull())||n.refreshState(),n.isSetup&&(e=n.selectable(),n.isPending||(t=n.getOption(s),t=n.getAdjacent(t,1),n.refreshOptions(n.isFocused&&"single"!==o),t&&n.setActiveOption(t)),!e.length||n.isFull()?n.close():n.isPending||n.positionDropdown(),n.trigger("item_add",s,i),n.isPending||n.updateOriginalInput({silent:r}))))})}},{key:"removeItem",value:function(e,t){var i,n,o=this.getItem(e);o&&(e=A(o.dataset.value),-1!==(i=this.items.indexOf(e))&&(o.remove(),o.classList.contains("active")&&(n=this.activeItems.indexOf(o),this.activeItems.splice(n,1),I(o,"active")),this.items.splice(i,1),this.lastQuery=null,!this.settings.persist&&this.userOptions.hasOwnProperty(e)&&this.removeOption(e,t),i<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updateOriginalInput({silent:t}),this.positionDropdown(),this.trigger("item_remove",e,o)))}},{key:"createItem",value:function(e,i){var t,n=this,o=n.caretPos;e=e||n.inputValue();var s=arguments[arguments.length-1];if("function"!=typeof s&&(s=function(){}),"boolean"!=typeof i&&(i=!0),!n.canCreate(e))return s(),!1;n.lock();function r(e){if(n.unlock(),!e||"object"!==l(e))return s();var t=A(e[n.settings.valueField]);if("string"!=typeof t)return s();n.setTextboxValue(""),n.addOption(e),n.setCaret(o),n.addItem(t),n.refreshOptions(i&&"single"!==n.settings.mode),s(e),a=!0}var a=!1;return"function"==typeof n.settings.create?t=n.settings.create.apply(this,[e,r]):((t={})[n.settings.labelField]=e,t[n.settings.valueField]=e),a||r(t),!0}},{key:"refreshItems",value:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()}},{key:"refreshState",value:function(){var e=this;e.refreshValidityState();var t=e.isFull(),i=e.isLocked;e.wrapper.classList.toggle("rtl",e.rtl);var n=e.control.classList;n.toggle("focus",e.isFocused),n.toggle("disabled",e.isDisabled),n.toggle("required",e.isRequired),n.toggle("invalid",e.isInvalid),n.toggle("locked",i),n.toggle("full",t),n.toggle("not-full",!t),n.toggle("input-active",e.isFocused&&!e.isInputHidden),n.toggle("dropdown-active",e.isOpen),n.toggle("has-options",(t=e.options,0===Object.keys(t).length)),n.toggle("has-items",0<e.items.length)}},{key:"refreshValidityState",value:function(){var e;this.input.checkValidity&&(e=!this.input.checkValidity(),this.isInvalid=e,this.control_input.required=e,this.input.required=!e)}},{key:"isFull",value:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems}},{key:"updateOriginalInput",value:function(e){var t,i,n,o,s=this;if(e=e||{},s.is_select_tag){for(n=[],t=0,i=s.items.length;t<i;t++)o=s.options[s.items[t]][s.settings.labelField]||"",n.push('<option value="'+h(s.items[t])+'" selected="selected">'+h(o)+"</option>");n.length||this.input.hasAttribute("multiple")||n.push('<option value="" selected="selected"></option>'),s.input.innerHTML=n.join("")}else s.input.value=s.getValue(),s.input.setAttribute("value",s.input.value);s.isSetup&&(e.silent||s.trigger("change",s.input.value))}},{key:"open",value:function(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.focus(),e.isOpen=!0,e.refreshState(),v(e.dropdown,{visibility:"hidden",display:"block"}),e.positionDropdown(),v(e.dropdown,{visibility:"visible",display:"block"}),e.trigger("dropdown_open",e.dropdown))}},{key:"close",value:function(){var e=this,t=e.isOpen;"single"===e.settings.mode&&e.items.length&&(e.hideInput(),e.isBlurring||e.blur()),e.isOpen=!1,v(e.dropdown,{display:"none"}),e.setActiveOption(null),e.refreshState(),t&&e.trigger("dropdown_close",e.dropdown)}},{key:"positionDropdown",value:function(){var e,t,i;"body"===this.settings.dropdownParent&&(e=(i=this.control).getBoundingClientRect(),t=i.offsetHeight+e.top+window.scrollY,i=e.left+window.scrollX,v(this.dropdown,{width:e.width+"px",top:t+"px",left:i+"px"}))}},{key:"clear",value:function(e){if(this.items.length){for(var t=this.controlChildren(),i=0;i<t.length;i++)t[i].remove();this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updateOriginalInput({silent:e}),this.refreshState(),this.showInput(),this.trigger("clear")}}},{key:"insertAtCaret",value:function(e){var t=Math.min(this.caretPos,this.items.length),i=this.buffer||this.control;0===t?i.insertBefore(e,i.firstChild):i.insertBefore(e,i.children[t]),this.setCaret(t+1)}},{key:"deleteSelection",value:function(e){var t,i,n,o=this,s=e&&8===e.keyCode?-1:1,r={start:(r=o.control_input).selectionStart,length:r.selectionEnd-r.selectionStart},a=[];if(o.activeItems.length){for(n=_(o.activeItems,s),n=m(n),0<s&&n++,t=0,i=o.activeItems.length;t<i;t++)a.push(o.activeItems[t].dataset.value);e&&(e.preventDefault(),e.stopPropagation())}else(o.isFocused||"single"===o.settings.mode)&&o.items.length&&(s<0&&0===r.start&&0===r.length?a.push(o.items[o.caretPos-1]):0<s&&r.start===o.inputValue().length&&a.push(o.items[o.caretPos]));if(!a.length||"function"==typeof o.settings.onDelete&&!1===o.settings.onDelete.apply(o,[a,e]))return!1;for(void 0!==n&&o.setCaret(n);a.length;)o.removeItem(a.pop());return o.showInput(),o.positionDropdown(),o.refreshOptions(!1),!0}},{key:"advanceSelection",value:function(e,t){var i;0!==e&&(this.rtl&&(e*=-1),this.isKeyDown(17,t)||this.isKeyDown(16,t)?(i=this.getLastActive(e),(t=this.getAdjacent(i,e,"item"))&&(t.classList.contains("active")&&this.removeActiveItem(i),this.setActiveItemClass(t))):this.isFocused&&!this.isInputHidden?this.inputValue().length||this.setCaret(this.caretPos+e):(i=this.getLastActive(e))&&(i=m(i),this.setCaret(0<e?i+1:i),this.setActiveItem(null)))}},{key:"getLastActive",value:function(e){var t=this.control.querySelector(".last-active");return t||function(e,t,i){t=e.querySelectorAll(t);if(t)return _(t,i)}(this.control,".active",e)}},{key:"setCaret",value:function(e){var t=this;if(e="single"===t.settings.mode||t.settings.controlInput?t.items.length:Math.max(0,Math.min(t.items.length,e)),!t.settings.controlInput&&!t.isPending)for(var i,n=this.controlChildren(),o=n.length,s=0;s<o;s++)i=n[s],s<e?t.control_input.insertAdjacentElement("beforebegin",i):t.control.appendChild(i);t.caretPos=e}},{key:"controlChildren",value:function(){return Array.prototype.filter.call(this.control.children,function(e){return"INPUT"!==e.nodeName})}},{key:"lock",value:function(){this.close(),this.isLocked=!0,this.refreshState()}},{key:"unlock",value:function(){this.isLocked=!1,this.refreshState()}},{key:"disable",value:function(){this.input.disabled=!0,this.control_input.disabled=!0,this.control_input.tabIndex=-1,this.isDisabled=!0,this.lock()}},{key:"enable",value:function(){this.input.disabled=!1,this.control_input.disabled=!1,this.control_input.tabIndex=this.tabIndex,this.isDisabled=!1,this.unlock()}},{key:"destroy",value:function(){var e=this.revertSettings;this.trigger("destroy"),this.off(),this.wrapper.remove(),this.dropdown.remove(),this.input.innerHTML="",e.tabindex?this.input.setAttribute("tabindex",e.tabindex):this.input.removeAttribute("tabindex"),I(this.input,"tomselected"),this.input.removeAttribute("hidden");for(var t=0;t<e.children.length;t++)this.input.appendChild(e.children[t]);this._destroy(),delete this.input.tomselect}},{key:"render",value:function(e,t){var i,n,o="",s=this;return"option"!==e&&"item"!==e||(i=A(t[s.settings.valueField]),!s.renderCache[e].hasOwnProperty(i))?(o=b(s.settings.render[e].apply(this,[t,h])),"option"===e||"option_create"===e?t[s.settings.disabledField]||o.setAttribute("data-selectable",""):"optgroup"===e&&(n=t.group[s.settings.optgroupValueField],o.setAttribute("data-group",n),t.group[s.settings.disabledField]&&o.setAttribute("data-disabled","")),"option"!==e&&"item"!==e||(o.setAttribute("data-value",i),C(o,"item"===e?s.settings.itemClass:s.settings.optionClass),s.renderCache[e][i]=o),o):s.renderCache[e][i]}},{key:"clearCache",value:function(e){void 0===e?this.renderCache={item:{},option:{}}:this.renderCache[e]={}}},{key:"canCreate",value:function(e){if(!this.settings.create)return!1;var t=this.settings.createFilter;return e.length&&("function"!=typeof t||t.call(this,e))&&(!(t instanceof RegExp)||t.test(e))}},{key:"isKeyDown",value:function(e,t){return!!t&&(!t.altKey&&((!t.ctrlKey||!t.shiftKey)&&(!(17!=e||!t.ctrlKey)||!(16!=e||!t.shiftKey))))}},{key:"hook",value:function(i,e,n){var o=this,s=o[e];o[e]=function(){var e,t;return"after"===i&&(e=s.apply(o,arguments)),t=n.apply(o,arguments),"instead"===i?t:("before"===i&&(e=s.apply(o,arguments)),e)}}}])&&n(e.prototype,t),i&&n(e,i),r}();if(void 0===e)throw'Dependency MicroPlugin is missing. Make sure you either: (1) are using the "complete" version of Tom Select, or (2) require MicroPlugin before you load Tom Select.';return e.mixin(S),S.count=0,S.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:50,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"ts-control",inputClass:"ts-input",dropdownClass:"ts-dropdown",dropdownContentClass:"ts-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:null,copyClassesToDropdown:!0,render:{}},S.define("change_listener",function(e){var t=this,i=!1;t.input.addEventListener("change",function(){var e;i?i=!1:(i=!0,e=y(t.input,{}),t.setupOptions(e.options,e.optgroups),t.setValue(e.items))})}),S.define("drag_drop",function(e){if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');var t,i,n;"multi"===this.settings.mode&&(i=(t=this).lock,n=t.unlock,t.hook("instead","lock",function(){var e=t.control.dataset.sortable;return e&&e.disable(),i.apply(t,arguments)}),t.hook("instead","unlock",function(){var e=t.control.dataset.sortable;return e&&e.enable(),n.apply(t,arguments)}),t.hook("after","setup",function(){var i=$(t.control).sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:t.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),i.css({overflow:"visible"})},stop:function(){i.css({overflow:"hidden"});var e=[];i.children("[data-value]").each(function(){e.push($(this).attr("data-value"))}),t.setValue(e)}})}))}),S.define("dropdown_header",function(t){var i=this;t=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a></div></div>'}},t),i.hook("after","setup",function(){var e=b(t.html(t));i.dropdown.insertBefore(e,i.dropdown.firstChild)})}),S.define("input_autogrow",function(e){var a=this;a.hook("after","setup",function(){var e=document.createElement("span"),t=this.control_input;e.style.position="absolute",e.style.top="-99999px",e.style.left="-99999px",e.style.width="auto",e.style.padding=0,e.style.whiteSpace="pre",a.wrapper.appendChild(e);for(var i=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"],n=0,o=i.length;n<o;n++){var s=i[n];e.style[s]=t.style[s]}function r(){e.textContent=t.value,t.style.width=e.clientWidth+"px"}t.addEventListener("input",r),t.addEventListener("keyup",r),t.addEventListener("blur",r),t.addEventListener("update",r)})}),S.define("no_backspace_delete",function(e){this.hook("instead","setActiveItem",function(){}),this.hook("instead","selectAll",function(){}),this.hook("instead","deleteSelection",function(){})}),S.define("optgroup_columns",function(e){var o=this,s=o.onKeyDown;o.hook("instead","onKeyDown",function(e){var t,i,n;return!o.isOpen||37!==e.keyCode&&39!==e.keyCode?s.apply(o,arguments):(o.ignoreHover=!0,n=k(o.activeOption,"[data-group]"),t=m(o.activeOption,"[data-selectable]"),void((n=37===e.keyCode?n.previousSibling:n.nextSibling)&&(i=(i=n.querySelectorAll("[data-selectable]"))[Math.min(i.length-1,t)])&&o.setActiveOption(i)))})}),S.define("remove_button",function(e){e=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},e);var n,o=this;e.append&&(n='<a href="javascript:void(0)" class="'+e.className+'" tabindex="-1" title="'+h(e.title)+'">'+e.label+"</a>",o.hook("after","setupTemplates",function(){var i=o.settings.render.item;o.settings.render.item=function(){var t=b(i.apply(o,arguments)),e=b(n);return t.appendChild(e),e.addEventListener("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),"single"!==o.settings.mode&&e.stopPropagation(),o.isLocked||(e=t.dataset.value,o.removeItem(e),o.refreshOptions(!1))}),t}}))}),S.define("restore_on_backspace",function(i){var n=this;i.text=i.text||function(e){return e[n.settings.labelField]};var o=n.onKeyDown;n.hook("instead","onKeyDown",function(e){var t;return 8===e.keyCode&&""===n.control_input.value&&!n.activeItems.length&&0<=(t=n.caretPos-1)&&t<n.items.length?(t=n.options[n.items[t]],n.deleteSelection(e)&&(n.setTextboxValue(i.text.call(n,t)),n.refreshOptions(!0)),void e.preventDefault()):o.apply(n,arguments)})}),S});var tomSelect=function(e,t){return new TomSelect(e,t)};